import java.io.*;
import java.util.*;

public class App {
   public static Scanner scanner = new Scanner(System.in);
   public static String name;
   public static Random random = new Random();
   public static int radif = 29;
   public static int ston = 2;
   public static int counter = 0;
   public static boolean win = false;
   public static long startTime;
   public static long endTime;

   public static int jon = 3;
   public static String[][] Map = {
           {"#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "\n"},
           {"#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "#", "#", " ", " ", " ", " ", " ", " ", "#", "#", "#", "#", " ", " ", " ", " ", " ", " ", "#", "#", "#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "\n"},
           {"#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "\n"},
           {"#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "\n"},
           {"#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", " ", " ", " ", " ", "#", "#", "#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "#", "#", " ", " ", " ", " ", " ", " ", "#", "#", "\n"},
           {"#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "\n"},
           {"#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "\n"},
           {"#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "#", "#", " ", " ", " ", " ", " ", " ", "#", "#", "#", "#", " ", " ", " ", " ", " ", " ", "#", "#", "#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", " ", " ", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", " ", " ", "#", "#", "\n"},
           {"#", "#", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "#", "#", "\n"},
           {"#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "\n"},
   };

   public static void main(String[] args) {
      menu();
      while (true) {
         int x = random.nextInt(10, 18);
         int y = random.nextInt(11, 21);
         int z = random.nextInt(5, 27);
         int c = random.nextInt(5, 27);
         int d = random.nextInt(5, 27);
         int q = random.nextInt(5, 27);
         int e = random.nextInt(5, 27);
         int r = random.nextInt(5, 27);
         int z1 = random.nextInt(5, 27);
         int c1 = random.nextInt(5, 27);
         int z2 = random.nextInt(5, 27);
         int c2 = random.nextInt(5, 27);
         int d2 = random.nextInt(5, 27);
         int q2 = random.nextInt(5, 27);
         int e2 = random.nextInt(5, 27);
         int r2 = random.nextInt(5, 27);
         int z12 = random.nextInt(5, 27);
         int c12 = random.nextInt(5, 27);
         if (Map[x][y].equals(" ") && Map[z][c].equals(" ") && Map[d][q].equals(" ") && Map[e][r].equals(" ") && Map[z1][c1].equals(" ") && Map[z2][c2].equals(" ") && Map[d2][q2].equals(" ") && Map[e2][r2].equals(" ") && Map[z12][c12].equals(" ")) {
            Map[x][y] = "*";
            Map[z][c] = "⚠";
            Map[d][q] = "⚠";
            Map[e][r] = "⚠";
            Map[z1][c1] = "⚠";
            Map[z12][c12] = "☢";
            Map[e2][r2] = "☢";
            Map[d2][q2] = "☢";
            break;
         }
      }

      while (jon >= 0) {
         Map[radif][ston] = "\u001B[31m@\u001B[0m";


         print();
         for (int i = 1; i <= jon; i++) {
            System.out.print("\uD83E\uDE77");
         }
         System.out.println();
         Map[radif][ston] = " ";
         move();
         counter++;
         System.out.println();
      }
      System.out.println("Game Over!");
      endgame();
   }

   public static void print() {
      for (int i = 0; i < Map.length; i++) {
         for (int j = 0; j < Map[i].length; j++) {
            if (counter == 0){
               System.out.print(Map[i][j]);
            }
            else if ((i - radif) > -4 && (i - radif) < 4 && (j - ston) > -8 && (j - ston) < 8) {
               System.out.print(Map[i][j]);
            } else {
               System.out.print("\u001B[34m?\u001B[0m");
            }
         }
         if (counter != 0)
            System.out.println();
      }
   }

   public static void move() {
      System.out.println("Directions: [W] up, [S] down, [A] left, [D] right");
      char D = scanner.next().charAt(0);
      switch (D) {
         case 'w':
         case 'W': {
            if(Map[radif - 1][ston].equals(" "))
               radif--;
            else if (Map[radif - 1][ston].equals("⚠")){
               radif = 29;
               ston = 2;
               System.out.println("You hit an obstacle");
               jon--;
            }
            else if (Map[radif - 1][ston].equals("#")){
               jon--;
            }
            else if (Map[radif - 1][ston].equals("☢")){
               jon--;
               Map[radif - 1][ston] = " ";
               System.out.println("BOOM!");
            }
            else if (Map[radif - 1][ston].equals("*")) {
               endgame();

            }
            break;
         }
         case 's':
         case 'S': {
            if(Map[radif + 1][ston].equals(" "))
               radif++;
            else if (Map[radif + 1][ston].equals("⚠")){
               radif = 29;
               ston = 2;
               System.out.println("You hit an obstacle");
               jon--;
            }
            else if (Map[radif + 1][ston].equals("#")){
               jon--;
            }
            else if (Map[radif + 1][ston].equals("☢")){
               jon--;
               Map[radif + 1][ston] = " ";
               System.out.println("BOOM!");
            }
            else if (Map[radif + 1][ston].equals("*")) {
               endgame();
            }
            break;
         }
         case 'a':
         case 'A': {
            if(Map[radif][ston - 1].equals(" "))
               ston--;
            else if (Map[radif][ston - 1].equals("⚠")){
               radif = 29;
               ston = 2;
               System.out.println("You hit an obstacle");
               jon--;
            }
            else if (Map[radif][ston - 1].equals("#")){
               jon--;
            }
            else if (Map[radif][ston - 1].equals("☢")){
               jon--;
               Map[radif][ston - 1] = " ";
               System.out.println("BOOM!");
            }
            else if (Map[radif][ston - 1].equals("*")) {
               endgame();
            }
            break;
         }
         case 'D':
         case 'd': {
         if(Map[radif][ston + 1].equals(" "))
            ston++;
         else if (Map[radif][ston + 1].equals("⚠")){
            radif = 29;
            ston = 2;
            System.out.println("You hit an obstacle");
            jon--;
         }
         else if (Map[radif][ston + 1].equals("#")){
            jon--;
         }
         else if (Map[radif][ston + 1].equals("☢")){
            jon--;
            Map[radif][ston + 1] = " ";
            System.out.println("BOOM!");
         }
         else if (Map[radif][ston + 1].equals("*")) {
            endgame();
         }
            break;
         }
         default: {
            System.out.println("Invalid direction!\nTry again!");
         }
      }
   }

      public static void menu(){
         System.out.println("1.START");
         System.out.println("2.LEADERBOARD");
         System.out.println("3.Exit");
         char l = scanner.next().charAt(0);
         switch(l)
         {
            case '1': {
               System.out.println("Please Enter Your Name:");
               name = scanner.next();
               startTime = System.currentTimeMillis();
               break;
            }
            case '2': {
               System.out.println("LEADERBOARD:\n");

               try {
                  Scanner fileScanner = new Scanner(new File("leaderboard.txt"));
                  while (fileScanner.hasNextLine()) {
                     String line = fileScanner.nextLine();
                     System.out.println(line);
                  }
                  fileScanner.close();
               } catch (FileNotFoundException e) {
                  System.out.println("Leaderboard file not found.");
               }
               System.out.println("\n");
               menu();
               break;
            }
            case '3': {
               System.out.println("Exiting the game. Goodbye!");
               System.exit(0);
               break;
            }
            default: {
               System.out.println("Invalid choice.\nTry again.");
               System.exit(0);
            }
         }
      }
      public static void endgame() {
      endTime = System.currentTimeMillis();
      long Time = endTime - startTime;
      long Seconds = Time / 1000;

      for (int i = 0; i < Map.length; i++) {
         for (int j = 0; j < Map[i].length; j++) {
            System.out.print(Map[i][j]);
         }
      }

      System.out.println("Name: " + name);
      System.out.println("Time: " + Seconds + " seconds");
      System.out.println("Steps: " + counter);

      if (win == true){
         try {
            FileWriter writer = new FileWriter("leaderboard.txt", true);
            writer.write("Name: " + name + ", Time: " + Seconds + " seconds, Steps: " + counter + "\n");
            writer.close();
         } catch (IOException e) {
            System.out.println("An error occurred while writing to the leaderboard file.");
         }
      }
         System.exit(0);
   }
}